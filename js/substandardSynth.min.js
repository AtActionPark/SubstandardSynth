function _asyncToGenerator(e){return function(){var h=e.apply(this,arguments);return new Promise(function(j,l){function u(y,z){try{var A=h[y](z),B=A.value}catch(C){return void l(C)}return A.done?void j(B):Promise.resolve(B).then(function(C){u('next',C)},function(C){u('throw',C)})}return u('next')})}}(function(){function Voice(e,h,j,l,u,y,z,A){this.name='empty',this.number=h,this.status='notPlaying',this.context=e,this.filters=z,this.oscillators=[],this.noises=[],this.hold=A,this.oscillatorsParams=j,this.noisesParams=l,this.instrGainNode=y,this.envelopeParams=u,this.gainNode=e.createGain(),this.gainNode.gain.value=0,this.gainNode.connect(this.filters[0]),this.lastGainValue=0}function sleep(e){return new Promise(h=>setTimeout(h,1e3*e))}function getRandomFloat(e,h){return rand()*(h-e)+e}function getRandomInt(e,h){return Math.floor(rand()*(h-e+1)+e)}function pickRandomProperty(e){let h=Object.keys(e);return h[h.length*rand()<<0]}function getRandomWave(){return waves[pickRandomProperty(waves)]}function getRandomNoise(){return noises[pickRandomProperty(noises)]}function getRandomFilter(){return filters[pickRandomProperty(filters)]}function getKeyByValue(e,h){return Object.keys(e).find(j=>e[j]===h)}function createWhiteNoise(e,h){for(i=0;i<e.length;i++)e[i]=2*(Math.random()-0.5)*h;return e}function createPinkNoise(e,h){let j,l,u,y,z,A,B;j=l=u=y=z=A=B=0;for(let D,C=0;C<e.length;C++)D=2*Math.random()-1,j=0.99886*j+0.0555179*D,l=0.99332*l+0.0750759*D,u=0.969*u+0.153852*D,y=0.8665*y+0.3104856*D,z=0.55*z+0.5329522*D,A=-0.7616*A-0.016898*D,e[C]=j+l+u+y+z+A+B+0.5362*D,e[C]*=0.11*h,B=0.115926*D;return e}function createBrownianNoise(e,h){let j=0;for(let u,l=0;l<e.length;l++)u=2*Math.random()-1,e[l]=(j+0.02*u)/1.02,j=e[l],e[l]*=3.5*h;return e}function b64EncodeUnicode(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(j,l){return String.fromCharCode('0x'+l)}))}function b64DecodeUnicode(e){return decodeURIComponent(atob(e).split('').map(function(h){return'%'+('00'+h.charCodeAt(0).toString(16)).slice(-2)}).join(''))}function escapeRegExp(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,'\\$&')}function packJson(e){let h=e.replace(/['"]+/g,'');h=h.substring(7);for(let l=0;l<min;l++){var j=new RegExp(escapeRegExp(toReplace[l]),'g');h=h.replace(j,dictionary[l])}return h=h.substring(0,h.length-1),unpackJson(h),h}function unpackJson(json){result='{o:{w:['+json;for(let e=0;e<min;e++){var re=new RegExp(escapeRegExp(dictionary[min-1-e]),'g');result=result.replace(re,toReplace[min-1-e])}return result+='}',result=eval('('+result+')'),result}function getFrequency(e){let h=e.slice(-1),j=e.slice(0,-1);return rootNotes[j]*Math.pow(2,h-3)}const baseOscNumber=5,maxGain=100,maxPeakLevel=100,maxSustainLevel=100,maxAttackTime=9999,maxDecayTime=9999,maxSustainTime=1e4,maxReleaseTime=9999;let seed=Math.random();SubstandardSynth=function(e){this.context=e.context||new AudioContext,this.outNode=e.outNode||this.context.createGain(),e.outNode||(this.outNode=this.context.createGain(),this.outNode.gain.value=1,this.outNode.connect(this.context.destination)),this.allowExport=e.export||!1,this.pageRoot=e.pageRoot,this.voicesNumber=e.voices||8,this.oscillatorsParams=e.defaultOscillators||[{wave:'square',detune:0}],this.noisesParams=e.defaultNoises||[],this.filtersParams=e.defaultFilters||[{type:'lowpass',frequency:2e4,q:1}],e.defaultFilters&&this.filtersParams.unshift({type:'lowpass',frequency:2e4,q:1}),this.filtersParams.forEach(h=>{h.gain=0,h.detune=0}),e.defaultEnvelope==void 0&&(e.defaultEnvelope={peakLevel:0.8,sustainLevel:0.3,attackTime:0.1,decayTime:0.1,releaseTime:0.1,sustainTime:10}),this.envelopeParams={peakLevel:e.defaultEnvelope.peakLevel||0.8,sustainLevel:e.defaultEnvelope.sustainLevel||0.3,attackTime:e.defaultEnvelope.attackTime||0.1,decayTime:e.defaultEnvelope.decayTime||0.1,releaseTime:e.defaultEnvelope.releaseTime||0.1,sustainTime:e.defaultEnvelope.sustainTime||10},this.distortionVal=e.distortion||0,this.synthDivID=e.ID||'synth',this.height=e.height||400,this.width=e.width||800,this.topCaseSize=void 0==e.topCaseSize?40:e.topCaseSize,this.caseSize=void 0==e.caseSize?20:e.caseSize,this.outBorderSize=void 0==e.outBorderSize?2:e.outBorderSize,this.panelBorderSize=void 0==e.panelBorderSize?1:e.panelBorderSize,this.panelBorderColor=e.panelBorderColor||'white',this.outBorderColor=e.outBorderColor||'white',this.borderColor=e.borderColor||'white',this.panelTextColor=e.panelTextColor||'black',this.caseColor=e.caseColor||'black',this.panelColor=e.panelColor||'#A9A9A9',this.panelTitleHeight=e.panelTitleHeight||20,this.panelTitleColor=e.panelTitleColor||'green',this.displaySynth=!(void 0!=e.display)||e.display,this.nbOfPanels=5,this.filters=[],this.hold=!0,this.chaos=0,this.sqrChaos=0,this.instrGainNode=this.context.createGain(),this.instrGainNode.gain.value=0.85,this.distortion=this.context.createWaveShaper(),this.setDistortion(this.distortionVal),this.compressor=this.context.createDynamicsCompressor(),this.compressor.threshold.value=-1,this.compressor.reduction.value=100,this.compressor.attack.value=0,this.limiter=this.context.createDynamicsCompressor(),this.distortion.connect(this.compressor),this.compressor.connect(this.instrGainNode),this.instrGainNode.connect(this.outNode),this.controlParams={gain:85,attack:10,decay:10,sustain:10,release:10,peakLevel:10,sustainLevel:10,hold:!0,distortion:0,chaos:0},this.setUpAndConnectFilters(),this.displaySynth&&this.display(),this.readURL(),this.generateSound()},SubstandardSynth.prototype.generateSound=function(){if(this.displaySynth&&(this.refreshControlValues(),this.refreshOscList(),this.refreshNoisesList(),this.refreshFiltersList()),this.setUpAndConnectFilters(),this.setVoices(),this.allowExport&&this.displaySynth){let e=this.generateSeed(),h=this.pageRoot+'?'+e;document.getElementById(this.synthDivID+'seedDivResult').href=h,document.getElementById(this.synthDivID+'seedDivResult').innerHTML='Export: '+h.trunc(this.width/9.5)}},SubstandardSynth.prototype.encodeInstrAsJson=function(){let e={},h={w:[],d:[]};this.oscillatorsParams.forEach(function(y){h.w.push(getKeyByValue(waves,y.wave)),h.d.push(Math.round(100*y.detune)/100)}),e.o=h;let j=[];this.noisesParams.forEach(function(y){j.push({t:parseInt(getKeyByValue(noises,y.type)),f:parseInt(getKeyByValue(filters,y.filterType)),v:y.volume,c:y.cutoff})}),e.n=j;let l=[];this.filtersParams.forEach(function(y){l.push({t:parseInt(getKeyByValue(filters,y.type)),c:y.frequency,q:Math.round(100*y.q)/100})}),e.f=l,e.e={a:Math.round(100*this.envelopeParams.attackTime)/100,d:Math.round(100*this.envelopeParams.decayTime)/100,s:Math.round(100*this.envelopeParams.sustainTime)/100,r:Math.round(100*this.envelopeParams.releaseTime)/100,l:Math.round(100*this.envelopeParams.peakLevel)/100,L:Math.round(100*this.envelopeParams.sustainLevel)/100},e.d=Math.round(this.distortionVal);let u=JSON.stringify(e);return u},SubstandardSynth.prototype.decodeFromJson=function(e){let h=[];for(let j=0;j<e.o.w.length;j++)h.push({wave:waves[e.o.w[j]],detune:e.o.d[j]});this.oscillatorsParams=h,this.noisesParams=e.n.map(j=>{return{type:noises[j.t],filterType:filters[j.f],volume:j.v,cutoff:j.c}}),this.filtersParams=e.f.map(j=>{return{type:filters[j.t],frequency:j.c,q:j.q,detune:0,gain:0}}),this.envelopeParams.attackTime=e.e.a,this.envelopeParams.decayTime=e.e.d,this.envelopeParams.sustainTime=e.e.s,this.envelopeParams.releaseTime=e.e.r,this.envelopeParams.peakLevel=e.e.l,this.envelopeParams.sustainLevel=e.e.L,this.distortionVal=e.d,this.instrGainNode.gain.value=0.85},SubstandardSynth.prototype.generateSeed=function(){let e=this.encodeInstrAsJson();e=packJson(e);let h=b64EncodeUnicode(e);return h},SubstandardSynth.prototype.readSeed=function(e){let h;if('string'==typeof e&&(h=e),!!h){h=b64DecodeUnicode(h);let j=unpackJson(h);this.decodeFromJson(j),this.displaySynth&&(this.refreshControlValues(),this.refreshOscList(),this.refreshNoisesList(),this.refreshFiltersList(),document.getElementById(this.synthDivID+'seedDivResult').href=this.generateSeed(e)),this.setUpAndConnectFilters(),this.setVoices()}},SubstandardSynth.prototype.readURL=function(){const e=window.location.href;if(e.includes('?')){let h=/\?([^&]+)/.exec(e)[1];return this.readSeed(h),!0}return!1},SubstandardSynth.prototype.setOscillators=function(){let e=Array.prototype.slice.call(arguments),h=this.oscillatorsParams;e.forEach(function(j){h.push(j)}),this.oscillatorsParams=h},SubstandardSynth.prototype.setNoises=function(){let e=Array.prototype.slice.call(arguments),h=this.noisesParams;e.forEach(function(j){h.push(j)}),this.noisesParams=h},SubstandardSynth.prototype.setEnvelope=function(e,h,j,l,u,y){this.envelopeParams.peakLevel=e||0.3,this.envelopeParams.sustainLevel=h||0.1,this.envelopeParams.attackTime=j||0.5,this.envelopeParams.decayTime=l||0.5,this.envelopeParams.releaseTime=u||0.5,this.envelopeParams.sustainTime=y||0.5},SubstandardSynth.prototype.setFilters=function(e,h,j,l,u){let y=this.context.createBiquadFilter();y.type=e,y.frequency.value=h,y.Q.value=l,y.detune.value=j,y.gain.value=u,this.filtersParams.push({type:e,frequency:h,detune:j,q:l,gain:u})},SubstandardSynth.prototype.setDistortion=function(e){this.distortionVal=e,e/=5;let z,h='number'==typeof e?e:50,j=44100,l=new Float32Array(j),u=Math.PI/180,y=0;for(;y<j;++y)z=2*y/j-1,l[y]=20*((3+h)*z)*u/(Math.PI+h*Math.abs(z));this.distortion.curve=l},SubstandardSynth.prototype.randomize=function(){this.oscillatorsParams=[],this.noisesParams=[],this.filtersParams=[{type:'lowpass',frequency:2e4,detune:0,q:1,gain:0}];let e=!1,h=getRandomInt(1,baseOscNumber+this.sqrChaos*baseOscNumber),j=getRandomInt(0,this.sqrChaos+1);this.instrGainNode.gain.value=0.85,this.distortionVal=100*getRandomFloat(0,this.chaos),this.setDistortion(this.distortionVal);for(let G=0;G<h;G++){let H=getRandomWave(),I=getRandomInt(100*-this.sqrChaos,100*this.sqrChaos);this.setOscillators({wave:H,detune:I})}let l=getRandomFloat(0.1,1/h),u=getRandomFloat(0.1,1/h),y=getRandomFloat(0,0.5+4*this.sqrChaos),z=getRandomFloat(0,0.5+4*this.sqrChaos),A=getRandomFloat(0,1.5+4*this.sqrChaos),B=getRandomFloat(0,1.5+4*this.sqrChaos);this.hold=!!(0.5>getRandomFloat(0,1)),this.hold&&(B=maxSustainTime/1e3),this.setEnvelope(l,u,y,z,A,B);for(let G=0;G<j;G++){let H=getRandomFilter(),I=getRandomInt(200,1e4);'highpass'==H&&(I=getRandomInt(200,4e3),e=!0);let J=getRandomInt(0,5+10*this.sqrChaos);this.setFilters(H,I,0,J,0)}e&&this.createLimiter();let C=getRandomNoise(),D=getRandomFilter(),E=getRandomInt(200,1e4),F=Math.round(100*getRandomFloat(0,0.2+5*this.sqrChaos))/100;this.setNoises({type:C,filterType:D,cutoff:E,volume:F}),this.generateSound()},SubstandardSynth.prototype.createLimiter=function(){this.limiter.threshold.value=-24,this.limiter.knee.value=0,this.limiter.ratio.value=20,this.limiter.attack.value=5e-3,this.limiter.release.value=0.05,this.instrGainNode.gain.value+=0.15,this.filters[this.filters.length-1].connect(this.limiter),this.limiter.connect(this.distortion)},SubstandardSynth.prototype.playNote=function(e,h){for(let j=0;j<this.voices.length;j++)if('notPlaying'==this.voices[j].status){this.voices[j].start(e,h);break}},SubstandardSynth.prototype.stopNote=function(e,h){for(let j=0;j<this.voices.length;j++)if('playing'==this.voices[j].status&&this.voices[j].name==e){this.voices[j].stop(h);break}},SubstandardSynth.prototype.remotePlayNotes=function(e,h,j){Array.isArray(e)||(e=[e]);for(let l=0;l<e.length;l++)isNaN(parseFloat(e[l]))&&!isFinite(e[l])&&(e[l]=getFrequency(e[l]));for(let l=0;l<e.length;l++)this.voices[l].playWithSetDuration(e[l],h,j)},SubstandardSynth.prototype.setVoices=function(){this.voices=[];for(let e=0;e<this.voicesNumber;e++)this.voices.push(new Voice(this.context,e+1,this.oscillatorsParams,this.noisesParams,this.envelopeParams,this.instrGainNode,this.filters,this.hold))},SubstandardSynth.prototype.setUpAndConnectFilters=function(){0<this.filters.length&&this.filters[this.filters.length-1].disconnect(),this.filters.length=0;for(let h,e=0;e<this.filtersParams.length;e++)h=this.context.createBiquadFilter(),h.type=this.filtersParams[e].type,h.frequency.value=this.filtersParams[e].frequency,h.detune.value=this.filtersParams[e].detune,h.Q.value=this.filtersParams[e].q,h.gain.value=this.filtersParams[e].gain,this.filters.push(h);for(let e=0;e<this.filters.length-1;e++)this.filters[e].connect(this.filters[e+1]);this.filters[this.filters.length-1].connect(this.distortion)},SubstandardSynth.prototype.kill=function(){for(let e=0;e<this.voices.length;e++)this.voices[e].stop(0);this.refreshFiltersList(),this.setUpAndConnectFilters(),this.setVoices()},SubstandardSynth.prototype.display=function(){this.interiorHeight=this.height-this.caseSize-this.topCaseSize,this.interiorWidth=this.width-2*this.caseSize-2*this.panelBorderSize-2*this.outBorderSize,this.panelHeight=this.interiorHeight-2*this.panelBorderSize,this.panelWidth=this.interiorWidth/this.nbOfPanels-2*this.panelBorderSize;let e=document.getElementById(this.synthDivID),h=document.createElement('div');h.style.height=this.height+'px',h.style.width=this.width+'px',h.style.backgroundColor='white',h.style.position='relative',h.style.backgroundColor=this.caseColor,h.style.border='solid '+this.outBorderSize+'px '+this.outBorderColor,h.style.fontFamily='Courier, sans-serif',h.style.fontSize='14px';let j=document.createElement('div');j.style.height=this.interiorHeight+'px',j.style.width=this.interiorWidth+'px',j.style.position='absolute',j.style.top=this.topCaseSize+'px',j.style.left=this.caseSize+'px',j.style.border='solid '+this.panelBorderSize+'px '+this.panelBorderColor;for(let u=0;u<this.nbOfPanels;u++)j.appendChild(this.addPanel(u));h.appendChild(j),e.appendChild(h);let l=document.createElement('a');l.id=this.synthDivID+'seedDivResult',l.innerHTML='',l.style.width=this.width-2*this.outBorderSize+'px',l.style.position='absolute',l.style.bottom='0px',l.style.left=this.caseSize+'px',l.style.color='white',h.appendChild(l),this.addControlsToPanels(),this.refreshControlValues(),this.refreshFiltersList(),this.refreshOscList()},SubstandardSynth.prototype.addPanel=function(e){let h=document.createElement('div');h.id=this.synthDivID+'PanelTitle'+e,h.innerHTML=panelNames[e],h.style.backgroundColor=this.panelTitleColor;let j=document.createElement('div');return j.id=this.synthDivID+'Panel'+e,j.style.height=this.panelHeight+'px',j.style.width=this.panelWidth+'px',j.style.position='absolute',j.style.left=e*(this.panelWidth+2*this.panelBorderSize)+'px',j.style.backgroundColor=this.panelColor,j.style.border='solid '+this.panelBorderSize+'px '+this.panelBorderColor,j.appendChild(h),j},SubstandardSynth.prototype.addControlsToPanels=function(){let e=document.getElementById(this.synthDivID+'Panel0');e.appendChild(this.setUpOscPanel(0));let h=document.getElementById(this.synthDivID+'Panel1');h.appendChild(this.setUpNoisePanel(0));let j=document.getElementById(this.synthDivID+'Panel2');j.appendChild(this.addSlider('Attack','attack',0,1,maxAttackTime,!0)),j.appendChild(this.addSlider('Decay','decay',40,1,maxDecayTime,!0)),j.appendChild(this.addSlider('Sustain','sustain',80,1,maxSustainTime,!0)),j.appendChild(this.addSlider('Release','release',120,1,maxReleaseTime,!0)),j.appendChild(this.addSlider('Peak Level','peakLevel',160,1,maxPeakLevel)),j.appendChild(this.addSlider('Sus. Level','sustainLevel',200,1,maxSustainLevel));let l=document.getElementById(this.synthDivID+'Panel4');l.appendChild(this.addSlider('Gain','gain',0,1,maxGain)),l.appendChild(this.addSlider('Distortion','distortion',40,0,100)),l.appendChild(this.addSlider('Chaos','chaos',this.panelHeight-105,0,100));let u=document.createElement('button');u.innerHTML='Randomize',u.onclick=this.randomize.bind(this),u.style.position='absolute',u.style.bottom='15px',u.style.left='10px',l.appendChild(u);let y=document.createElement('button');y.innerHTML='Kill',y.onclick=this.kill.bind(this),y.style.position='absolute',y.style.bottom='100px',y.style.left='10px',l.appendChild(y);let z=document.getElementById(this.synthDivID+'Panel3');z.appendChild(this.setUpFilterPanel(0))},SubstandardSynth.prototype.addSlider=function(e,h,j,l,u,y){let z=this,A=document.createElement('div');A.style.position='absolute',A.style.top=j+this.panelTitleHeight+'px';let B=document.createElement('p');B.innerHTML=e,B.style.width='150px',B.style.position='absolute',B.style.left='5px',B.style.margin=0,B.style.padding=0,B.style.color=this.panelTextColor;let C=document.createElement('p');C.id=h+'Value',C.innerHTML=this.controlParams[h],C.style.position='absolute',C.style.left=this.panelWidth-35+'px',C.style.margin=0,C.style.padding=0,C.style.color=this.panelTextColor,A.appendChild(B),A.appendChild(C);let D=document.createElement('input');return D.id=h+'Slider',D.classList.add('slider'),D.style.position='absolute',D.style.left='5px',D.style.top='15px',D.style.width=this.panelWidth-15+'px',D.type='range',D.min=l,D.max=u,D.step=1,D.value=this.controlParams[h],D.onchange=function(){let E=this.value;y&&(E=Math.round(Math.pow(E/u,2)*u)),z.controlParams[h]=E,C.innerHTML=E,'sustain'==h&&this.value==maxSustainTime&&(C.innerHTML='&#8734'),z.getUserInput()},A.appendChild(D),A},SubstandardSynth.prototype.setUpOscPanel=function(e){let h=this,j=document.createElement('div');j.style.position='absolute',j.style.top=e+this.panelTitleHeight+'px';let l=document.createElement('p');l.innerHTML='Wave: ',l.style.width='150px',l.style.position='absolute',l.style.left='5px',l.style.margin=0,l.style.padding=0,l.style.color=this.panelTextColor,j.appendChild(l);let u=document.createElement('select'),y=['sine','square','triangle','sawtooth'];for(let G,F=0;F<y.length;F++)G=document.createElement('option'),G.value=y[F],G.text=y[F],u.appendChild(G);u.id='waveDropBox',u.classList.add('dropBox'),u.style.position='absolute',u.style.left='5px',u.style.top='20px',u.type='text',j.appendChild(u);let z=document.createElement('p');z.innerHTML='Detune: ',z.style.width='150px',z.style.position='absolute',z.style.left='5px',z.style.top='45px',z.style.margin=0,z.style.padding=0,z.style.color=this.panelTextColor,j.appendChild(z);let A=document.createElement('input');A.id='detuneNumberBox',A.type='number',A.value=0,A.classList.add('numberBox'),A.style.position='absolute',A.style.left='5px',A.style.top='65px',A.style.width='60px',j.appendChild(A);let B=document.createElement('button');B.innerHTML='Add',B.style.position='absolute',B.style.left='5px',B.style.top='95px',B.onclick=function(){let F=u.options[u.selectedIndex].value,G=parseFloat(A.value)||0;h.oscillatorsParams.push({wave:F,detune:G}),h.generateSound()},j.appendChild(B);let C=document.createElement('p');C.innerHTML='Oscillators: ',C.style.width='150px',C.style.position='absolute',C.style.left='5px',C.style.top='140px',C.style.margin=0,C.style.padding=0,C.style.color=this.panelTextColor;let D=document.createElement('select');D.id='oscillatorsDropBox',D.classList.add('dropBox'),D.style.position='absolute',D.style.left='5px',D.style.top='160px',D.type='text',j.appendChild(C),j.appendChild(D);let E=document.createElement('button');return E.innerHTML='Remove',E.style.position='absolute',E.style.left='5px',E.style.top='190px',E.onclick=function(){D.options[D.selectedIndex].value;h.oscillatorsParams.splice(D.selectedIndex,1),h.generateSound()},j.appendChild(E),j},SubstandardSynth.prototype.setUpNoisePanel=function(e){let h=this,j=document.createElement('div');j.style.position='absolute',j.style.top=e+this.panelTitleHeight+'px';let l=document.createElement('p');l.innerHTML='Noise type: ',l.style.width='150px',l.style.position='absolute',l.style.left='5px',l.style.margin=0,l.style.padding=0,l.style.color=this.panelTextColor,j.appendChild(l);let u=document.createElement('select'),y=['white','pink','brownian'];for(let L,K=0;K<y.length;K++)L=document.createElement('option'),L.value=y[K],L.text=y[K],u.appendChild(L);u.id='typeDropBox',u.classList.add('dropBox'),u.style.position='absolute',u.style.left='5px',u.style.top='20px',u.type='text',j.appendChild(u);let z=document.createElement('p');z.innerHTML='Volume: ',z.style.width='150px',z.style.position='absolute',z.style.left='5px',z.style.top='45px',z.style.margin=0,z.style.padding=0,z.style.color=this.panelTextColor,j.appendChild(z);let A=document.createElement('input');A.id='filterVolumeNumberBox',A.type='number',A.value=0,A.classList.add('numberBox'),A.style.position='absolute',A.style.left='5px',A.style.top='65px',A.style.width='60px',j.appendChild(A);let B=document.createElement('p');B.innerHTML='Filter Type: ',B.style.width='150px',B.style.position='absolute',B.style.left='5px',B.style.top='90px',B.style.margin=0,B.style.padding=0,B.style.color=this.panelTextColor,j.appendChild(B);let C=document.createElement('select'),D=['highpass','lowpass','bandpass','notch'];for(let L,K=0;K<D.length;K++)L=document.createElement('option'),L.value=D[K],L.text=D[K],C.appendChild(L);C.id='typeDropBox',C.classList.add('dropBox'),C.style.position='absolute',C.style.left='5px',C.style.top='110px',C.type='text',j.appendChild(C);let E=document.createElement('p');E.innerHTML='Filter Cutoff: ',E.style.width='150px',E.style.position='absolute',E.style.left='5px',E.style.top='135px',E.style.margin=0,E.style.padding=0,E.style.color=this.panelTextColor,j.appendChild(E);let F=document.createElement('input');F.id='filterCutoffNumberBox',F.type='number',F.value=0,F.classList.add('numberBox'),F.style.position='absolute',F.style.left='5px',F.style.top='155px',F.style.width='60px',j.appendChild(F);let G=document.createElement('button');G.innerHTML='Add',G.style.position='absolute',G.style.left='5px',G.style.top='185px',G.onclick=function(){let K=u.options[u.selectedIndex].value,L=C.options[C.selectedIndex].value,M=parseInt(F.value)||0,N=parseFloat(A.value)||0;h.noisesParams.push({type:K,filterType:L,cutoff:M,volume:N}),h.generateSound()},j.appendChild(G);let H=document.createElement('p');H.innerHTML='Noises list: ',H.style.width='150px',H.style.position='absolute',H.style.left='5px',H.style.top='225px',H.style.margin=0,H.style.padding=0,H.style.color=this.panelTextColor;let I=document.createElement('select');I.id='noisesDropBox',I.classList.add('dropBox'),I.style.position='absolute',I.style.left='5px',I.style.top='245px',I.type='text',j.appendChild(H),j.appendChild(I);let J=document.createElement('button');return J.innerHTML='Remove',J.style.position='absolute',J.style.left='5px',J.style.top='275px',J.onclick=function(){h.noisesParams.splice(I.selectedIndex,1),h.generateSound()},j.appendChild(J),j},SubstandardSynth.prototype.setUpFilterPanel=function(e){let h=this,j=document.createElement('div');j.style.position='absolute',j.style.top=e+this.panelTitleHeight+'px';let l=document.createElement('p');l.innerHTML='Filter Type: ',l.style.width='150px',l.style.position='absolute',l.style.left='5px',l.style.top='0px',l.style.margin=0,l.style.padding=0,l.style.color=this.panelTextColor,j.appendChild(l);let u=document.createElement('select'),y=['highpass','lowpass','bandpass','notch'];for(let I,H=0;H<y.length;H++)I=document.createElement('option'),I.value=y[H],I.text=y[H],u.appendChild(I);u.id='typeDropBox',u.classList.add('dropBox'),u.style.position='absolute',u.style.left='5px',u.style.top='20px',u.type='text',j.appendChild(u);let z=document.createElement('p');z.innerHTML='Filter Cutoff: ',z.style.width='150px',z.style.position='absolute',z.style.left='5px',z.style.top='45px',z.style.margin=0,z.style.padding=0,z.style.color=this.panelTextColor,j.appendChild(z);let A=document.createElement('input');A.id='filterCutoffNumberBox',A.type='number',A.value=0,A.classList.add('numberBox'),A.style.position='absolute',A.style.left='5px',A.style.top='65px',A.style.width='60px',j.appendChild(A);let B=document.createElement('p');B.innerHTML='Filter Q: ',B.style.width='150px',B.style.position='absolute',B.style.left='5px',B.style.top='90px',B.style.margin=0,B.style.padding=0,B.style.color=this.panelTextColor,j.appendChild(B);let C=document.createElement('input');C.id='filterQNumberBox',C.type='number',C.value=0,C.classList.add('numberBox'),C.style.position='absolute',C.style.left='5px',C.style.top='110px',C.style.width='60px',j.appendChild(C);let D=document.createElement('button');D.innerHTML='Add',D.style.position='absolute',D.style.left='5px',D.style.top='140px',D.onclick=function(){let H=u.options[u.selectedIndex].value,I=parseInt(A.value)||0,K=parseInt(C.value)||0;h.filtersParams.push({type:H,frequency:I,detune:0,q:K,gain:0}),h.generateSound()},j.appendChild(D);let E=document.createElement('p');E.innerHTML='Filters: ',E.style.width='150px',E.style.position='absolute',E.style.left='5px',E.style.top='225px',E.style.margin=0,E.style.padding=0,E.style.color=this.panelTextColor;let F=document.createElement('select');F.id='filtersDropBox',F.classList.add('dropBox'),F.style.position='absolute',F.style.left='5px',F.style.top='245px',F.type='text',j.appendChild(E),j.appendChild(F);let G=document.createElement('button');return G.innerHTML='Remove',G.style.position='absolute',G.style.left='5px',G.style.top='275px',G.onclick=function(){1>=h.filters.length||(h.filtersParams.splice(F.selectedIndex+1,1),h.generateSound())},j.appendChild(G),j},SubstandardSynth.prototype.refreshOscList=function(){let e=document.getElementById('oscillatorsDropBox'),h=[];for(let j=0;j<this.oscillatorsParams.length;j++)h.push({wave:this.oscillatorsParams[j].wave,detune:this.oscillatorsParams[j].detune});e.options.length=0;for(let l,j=0;j<h.length;j++)l=document.createElement('option'),l.value=h[j].wave,l.text=h[j].wave+' - d: '+Math.round(100*h[j].detune)/100,e.appendChild(l)},SubstandardSynth.prototype.refreshNoisesList=function(){let e=document.getElementById('noisesDropBox'),h=[];for(let j=0;j<this.noisesParams.length;j++)h.push({type:this.noisesParams[j].type,filterType:this.noisesParams[j].filterType,cutoff:this.noisesParams[j].cutoff,volume:this.noisesParams[j].volume});e.options.length=0;for(let l,j=0;j<h.length;j++)l=document.createElement('option'),l.value=h[j].type,l.text=h[j].type.charAt(0)+'-'+h[j].filterType.charAt(0)+'-'+h[j].cutoff+'-'+Math.round(100*h[j].volume)/100,e.appendChild(l)},SubstandardSynth.prototype.refreshFiltersList=function(){let e=document.getElementById('filtersDropBox'),h=[];for(let j=1;j<this.filtersParams.length;j++)h.push({type:this.filtersParams[j].type,frequency:this.filtersParams[j].frequency,detune:this.filtersParams[j].detune,q:this.filtersParams[j].q,gain:this.filtersParams[j].gain});e.options.length=0;for(let l,j=0;j<h.length;j++)l=document.createElement('option'),l.value=h[j].type,l.text=h[j].type.charAt(0)+'-'+h[j].frequency+'-'+Math.round(10*h[j].q)/10,e.appendChild(l)},SubstandardSynth.prototype.setControl=function(e,h,j,l){let u=h;j&&(u=Math.sqrt(h/l,2)*l);let y;y='sustain'==e&&h==maxSustainTime?'&#8734':Math.round(h),this.controlParams[e]=Math.round(h),document.getElementById(e+'Slider').value=Math.round(u),document.getElementById(e+'Value').innerHTML=y},SubstandardSynth.prototype.getUserInput=function(){this.instrGainNode.gain.value=this.controlParams.gain/maxGain,this.setDistortion(this.controlParams.distortion),this.chaos=this.controlParams.chaos/100,this.sqrChaos=this.chaos*this.chaos,this.envelopeParams.peakLevel=this.controlParams.peakLevel/maxPeakLevel,this.envelopeParams.sustainLevel=this.controlParams.sustainLevel/maxSustainLevel,this.envelopeParams.attackTime=this.controlParams.attack/1e3,this.envelopeParams.decayTime=this.controlParams.decay/1e3,this.envelopeParams.sustainTime=this.controlParams.sustain/1e3,this.envelopeParams.releaseTime=this.controlParams.release/1e3,this.hold=!(this.envelopeParams.sustainTime!=maxSustainTime/1e3),this.generateSound()},SubstandardSynth.prototype.refreshControlValues=function(){this.setControl('gain',this.instrGainNode.gain.value*maxGain),this.setControl('distortion',this.distortionVal),this.setControl('peakLevel',this.envelopeParams.peakLevel*maxPeakLevel),this.setControl('sustainLevel',this.envelopeParams.sustainLevel*maxSustainLevel),this.setControl('attack',1e3*this.envelopeParams.attackTime,!0,maxAttackTime),this.setControl('decay',1e3*this.envelopeParams.decayTime,!0,maxDecayTime),this.setControl('sustain',1e3*this.envelopeParams.sustainTime,!0,maxSustainTime),this.setControl('release',1e3*this.envelopeParams.releaseTime,!0,maxReleaseTime)},Voice.prototype.start=function(e,h){let j=this.context.currentTime+h;if(this.status='playing',this.name=e,this.oscillators.forEach(l=>{l.stop(j)}),this.noises.forEach(l=>{l.stop(j)}),this.oscillators=[],this.noises=[],this.oscillatorsParams.forEach(l=>{let u=this.createOsc(l.wave,e+l.detune,this.gainNode);this.oscillators.push(u),u.start(j)}),this.noisesParams.forEach(l=>{let u=this.createNoise(l.type,l.filterType,l.cutoff,l.volume,this.gainNode);this.noises.push(u),u.start(j)}),this.lastGainValue=this.gainNode.gain.value,this.gainNode.gain.cancelScheduledValues(j),this.gainNode.gain.setValueAtTime(this.lastGainValue,j),this.gainNode.gain.linearRampToValueAtTime(this.envelopeParams.peakLevel,j+this.envelopeParams.attackTime),this.gainNode.gain.setValueAtTime(this.envelopeParams.peakLevel,j+this.envelopeParams.attackTime),this.gainNode.gain.linearRampToValueAtTime(this.envelopeParams.sustainLevel,j+this.envelopeParams.attackTime+this.envelopeParams.decayTime),this.gainNode.gain.setValueAtTime(this.envelopeParams.sustainLevel,j+this.envelopeParams.attackTime+this.envelopeParams.decayTime),!this.hold){this.gainNode.gain.setValueAtTime(this.envelopeParams.sustainLevel,j+this.envelopeParams.attackTime+this.envelopeParams.decayTime+this.envelopeParams.sustainTime);let l=j+this.envelopeParams.attackTime+this.envelopeParams.decayTime+this.envelopeParams.sustainTime+this.envelopeParams.releaseTime;this.gainNode.gain.linearRampToValueAtTime(1e-3,l),this.gainNode.gain.setValueAtTime(0,l)}},Voice.prototype.stop=(()=>{var e=_asyncToGenerator(function*(h){let j=this.context.currentTime+h;this.lastGainValue=this.gainNode.gain.value,this.gainNode.gain.cancelScheduledValues(j);let l=j+this.envelopeParams.releaseTime;this.gainNode.gain.setValueAtTime(this.lastGainValue,j),this.gainNode.gain.exponentialRampToValueAtTime(1e-3,l),this.gainNode.gain.setValueAtTime(0,l),this.oscillators.forEach(function(u){u.stop(l)}),this.noises.forEach(function(u){u.stop(l)}),yield sleep(this.releaseTime),this.status='notPlaying',this.name='empty'});return function(){return e.apply(this,arguments)}})(),Voice.prototype.playWithSetDuration=function(e,h,j){this.start(e,h),this.stop(h+j)},Voice.prototype.createOsc=function(e,h,j){let l=this.context.createOscillator();return l.frequency.value=h,l.type=e,l.connect(j),l},Voice.prototype.createNoise=function(e,h,j,l,u){let y=2*this.context.sampleRate,z=this.context.createBuffer(1,y,this.context.sampleRate),A=z.getChannelData(0);'white'==e?A=createWhiteNoise(A,l):'pink'==e?A=createPinkNoise(A,l):'brownian'==e&&(A=createBrownianNoise(A,l));let B=this.context.createBufferSource();B.loop=!0,B.buffer=z;let C=this.context.createBiquadFilter();return C.type=h,C.frequency.value=j,B.connect(C),C.connect(u),B};const waves={0:'sine',1:'square',2:'triangle',3:'sawtooth'},noises={0:'white',1:'pink',2:'brownian'},filters={0:'lowpass',1:'highpass',2:'bandpass',3:'notch'},panelNames={0:'_OSC',1:'_NOISE',2:'_ENVELOPE',3:'_FILTER',4:'_MISC'},m=25;let rand=function(){return seed=(11*seed+17)%m,seed/m};let dictionary='pnmtxzvcqeiysrlLg%@#$^()_!`*/-ABCDEFGHIJKMNOPQRSTUVWXXZ'.split(''),toReplace=['],d:[',']},n:[','],f:[{t:','{t:','},t',',f:',',v:',',c:',',q:','],e:{a:','},d:',',d:',',s:',',r:',',l:',',L:',',g:','}]z[e',',0',',1',',2',',3',',4',',5',',6',',7',',8',',9',',-','0.','1.','2.','3.','4.','-0','-1','-2','-3','-4','-5'],min=Math.min(dictionary.length,toReplace.length);const rootNotes={C:261.626,'C#':277.183,D:293.665,'D#':311.127,E:329.628,F:349.228,'F#':369.994,G:391.995,'G#':415.305,A:440,'A#':466.164};String.prototype.trunc=String.prototype.trunc||function(e){return this.length>e?this.substr(0,e-1)+'&hellip;':this}})();